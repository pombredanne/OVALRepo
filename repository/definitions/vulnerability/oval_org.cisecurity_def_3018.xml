<definition xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" class="vulnerability" id="oval:org.cisecurity:def:3018" version="6">
  <metadata>
    <title>Microsoft SQL Server Analysis Services Information Disclosure Vulnerability - CVE-2017-8516</title>
    <affected family="windows">
      <platform>Microsoft Windows Server 2008</platform>
      <platform>Microsoft Windows 7</platform>
      <platform>Microsoft Windows Server 2008 R2</platform>
      <platform>Microsoft Windows 8.1</platform>
      <platform>Microsoft Windows Server 2012</platform>
      <platform>Microsoft Windows Server 2012 R2</platform>
      <platform>Microsoft Windows 10</platform>
      <platform>Microsoft Windows Server 2016</platform>
      <product>Microsoft SQL Server 2012</product>
      <product>Microsoft SQL Server 2014</product>
      <product>Microsoft SQL Server 2016</product>
    </affected>
    <reference ref_id="CVE-2017-8516" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-8516" source="CVE" />
    <description>Microsoft SQL Server Analysis Services in Microsoft SQL Server 2012, Microsoft SQL Server 2014, and Microsoft SQL Server 2016 allows an information disclosure vulnerability when it improperly enforces permissions, aka "Microsoft SQL Server Analysis Services Information Disclosure Vulnerability".</description>
    <oval_repository>
      <dates>
        <submitted date="2017-08-22T20:02:08+00:00">
          <contributor organization="DTCC">Alexander Chua</contributor>
        </submitted>
        <status_change date="2017-08-25T12:00:00.000-05:00">DRAFT</status_change>
        <status_change date="2017-09-08T11:00:00.000-05:00">INTERIM</status_change>
        <status_change date="2017-09-22T12:00:00.000-05:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.10</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria comment="Check for installation vulnerable Microsoft SQL Server + vulnerable file version" operator="OR">
    <criteria comment="Microsoft SQL Server 2012 is installed + file version" operator="AND">
      <extend_definition comment="Microsoft SQL Server 2012 SP3 is installed" definition_ref="oval:org.cisecurity:def:1515" />
      <criteria comment="Check for file version" operator="OR">
        <criterion comment="Check if Microsoft.sqlserver.chainer.infrastructure.dll version is greater than or equal 11.0.6020.0 and less than 11.0.6251.0" test_ref="oval:org.cisecurity:tst:4112" />
        <criterion comment="Check if Microsoft.sqlserver.chainer.infrastructure.dll version (CU) is greater than or equal 11.0.6518.0 and less than 11.0.6607.3" test_ref="oval:org.cisecurity:tst:4109" />
      </criteria>
    </criteria>
    <criteria comment="Microsoft SQL Server 2014 SP1 is installed + file version" operator="AND">
      <extend_definition comment="Microsoft SQL Server 2014 SP1 installed" definition_ref="oval:org.cisecurity:def:1493" />
      <criteria comment="Check for file version" operator="OR">
        <criterion comment="Check if Microsoft.sqlserver.chainer.infrastructure.dll version is greater than or equal 12.0.4100.1 and less than 12.0.4237.0" test_ref="oval:org.cisecurity:tst:4114" />
        <criterion comment="Check if Microsoft.sqlserver.chainer.infrastructure.dll version (CU) is greater than or equal 12.0.4416.0 and less than 12.0.4522.0" test_ref="oval:org.cisecurity:tst:4118" />
      </criteria>
    </criteria>
    <criteria comment="Microsoft SQL Server 2014 SP2 is installed + file version" operator="AND">
      <extend_definition comment="Microsoft SQL Server 2014 SP2 installed" definition_ref="oval:org.cisecurity:def:1495" />
      <criteria comment="Check for file version" operator="OR">
        <criterion comment="Check if Microsoft.sqlserver.chainer.infrastructure.dll version is greater than or equal 12.0.5000.0 and less than 12.0.5207.0" test_ref="oval:org.cisecurity:tst:4116" />
        <criterion comment="Check if Microsoft.sqlserver.chainer.infrastructure.dll version (CU) is greater than or equal 12.0.5511.0 and less than 12.0.5553.0" test_ref="oval:org.cisecurity:tst:4117" />
      </criteria>
    </criteria>
    <criteria comment="Microsoft SQL Server 2016 is installed + file version" operator="AND">
      <extend_definition comment="Microsoft SQL Server 2016 is installed" definition_ref="oval:org.cisecurity:def:1494" />
      <criteria comment="Check for file version" operator="OR">
        <criterion comment="Check if Microsoft.sqlserver.chainer.infrastructure.dll version is greater than or equal 13.0.1601.5 and less than 13.0.1742.0" test_ref="oval:org.cisecurity:tst:4113" />
        <criterion comment="Check if Microsoft.sqlserver.chainer.infrastructure.dll version (CU) is greater than or equal 13.0.2149.0 and less than 13.0.2210.0" test_ref="oval:org.cisecurity:tst:4115" />
      </criteria>
    </criteria>
    <criteria comment="Microsoft SQL Server 2016 SP1 is installed + file version" operator="AND">
      <extend_definition comment="Microsoft SQL Server 2016 SP1 is installed" definition_ref="oval:org.cisecurity:def:3017" />
      <criteria comment="Check for file version" operator="OR">
        <criterion comment="Check if Microsoft.sqlserver.chainer.infrastructure.dll version is greater than or equal 13.0.4001.0 and less than 13.0.4206.0" test_ref="oval:org.cisecurity:tst:4119" />
        <criterion comment="Check if Microsoft.sqlserver.chainer.infrastructure.dll version (CU) is greater than or equal 13.0.4411.0 and less than 13.0.4446.0" test_ref="oval:org.cisecurity:tst:4111" />
      </criteria>
    </criteria>
  </criteria>
</definition>
