<definition xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" class="vulnerability" id="oval:org.cisecurity:def:1514" version="7">
  <metadata>
    <title>SQL Server Agent Elevation of Privilege Vulnerability - CVE-2016-7253 (MS16-136)</title>
    <affected family="windows">
      <platform>Microsoft Windows Server 2008</platform>
      <platform>Microsoft Windows Server 2008 R2</platform>
      <platform>Microsoft Windows Server 2012</platform>
      <platform>Microsoft Windows Server 2012 R2</platform>
      <platform>Microsoft Windows Server 2016</platform>
      <platform>Microsoft Windows 8</platform>
      <platform>Microsoft Windows 8.1</platform>
      <platform>Microsoft Windows 10</platform>
      <product>Microsoft SQL Server 2012</product>
      <product>Microsoft SQL Server 2014</product>
    </affected>
    <reference ref_id="CVE-2016-7253" ref_url="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-7253" source="CVE" />
    <description>The agent in Microsoft SQL Server 2012 SP2, 2012 SP3, 2014 SP1, 2014 SP2, and 2016 does not properly check the atxcore.dll ACL, which allows remote authenticated users to gain privileges via unspecified vectors, aka "SQL Server Agent Elevation of Privilege Vulnerability."</description>
    <oval_repository>
      <dates>
        <submitted date="2016-12-07T00:00:00+08:00">
          <contributor organization="DTCC">Jeff Albert</contributor>
        </submitted>
        <status_change date="2016-12-09T12:00:00.000-05:00">DRAFT</status_change>
        <status_change date="2016-12-23T14:00:00.000-05:00">INTERIM</status_change>
        <status_change date="2017-01-06T12:00:00.000-05:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.10</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria comment="MS SQL Server+ vulnerable range" operator="OR">
    <criteria comment="Microsoft SQL Server 2012 SP2 + vulnerable range" operator="AND">
      <extend_definition comment="Microsoft SQL Server 2012 SP2 is installed" definition_ref="oval:org.mitre.oval:def:29429" />
      <criteria comment="Check for vulnerable range" operator="OR">
        <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is less than 11.0.5388.0" test_ref="oval:org.cisecurity:tst:2231" />
        <criteria comment="SQL Server 2012 SP2 CU15" operator="AND">
          <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is less than 11.0.5676.0" test_ref="oval:org.cisecurity:tst:2228" />
          <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is greater than or equal to 11.0.5500.0" test_ref="oval:org.cisecurity:tst:2230" />
        </criteria>
      </criteria>
    </criteria>
    <criteria comment="Microsoft SQL Server 2012 SP3 + vulnerable range" operator="AND">
      <extend_definition comment="Microsoft SQL Server 2012 SP3 is installed" definition_ref="oval:org.cisecurity:def:1515" />
      <criteria comment="Check for vulnerable range" operator="OR">
        <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is less than 11.0.6248.0" test_ref="oval:org.cisecurity:tst:2226" />
        <criteria comment="SQL Server 2012 SP3 CU6" operator="AND">
          <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is less than 11.0.6567.0" test_ref="oval:org.cisecurity:tst:2229" />
          <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is greater than or equal to 11.0.6300.0" test_ref="oval:org.cisecurity:tst:2227" />
        </criteria>
      </criteria>
    </criteria>
    <criteria comment="MS SQL Server 2014 SP1 + vulnerable range" operator="AND">
      <extend_definition comment="Microsoft SQL Server 2014 SP1 installed" definition_ref="oval:org.cisecurity:def:1493" />
      <criteria comment="Check for vulnerable range" operator="OR">
        <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is less than 12.0.4232.0" test_ref="oval:org.cisecurity:tst:2193" />
        <criteria comment="SQL Server 2014 SP1 CU9" operator="AND">
          <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is less than 12.0.4487.0" test_ref="oval:org.cisecurity:tst:2185" />
          <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is greater than or equal to 12.0.4400.0" test_ref="oval:org.cisecurity:tst:2188" />
        </criteria>
      </criteria>
    </criteria>
    <criteria comment="MS SQL Server 2014 SP2 + vulnerable range" operator="AND">
      <extend_definition comment="Microsoft SQL Server 2014 SP2 installed" definition_ref="oval:org.cisecurity:def:1495" />
      <criteria comment="Check for vulnerable range" operator="OR">
        <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is less than 12.0.5203.0" test_ref="oval:org.cisecurity:tst:2184" />
        <criteria comment="SQL Server 2014 SP2 CU2" operator="AND">
          <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is less than 12.0.5532.0" test_ref="oval:org.cisecurity:tst:2192" />
          <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is greater than or equal to 12.0.5400.0" test_ref="oval:org.cisecurity:tst:2187" />
        </criteria>
      </criteria>
    </criteria>
  </criteria>
</definition>
